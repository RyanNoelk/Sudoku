!function(t,e){"function"==typeof define&&define.amd?define(["jquery"],e):e(t.jQuery)}(this,function(t){function e(e){var n=e.element;t(n).data("intr",setInterval(a.bind(e),e.options.updateFrequency)),t(n).data("isTimerRunning",!0)}function n(e){clearInterval(t(e.element).data("intr")),t(e.element).data("isTimerRunning",!1)}function a(){t(this.element).data("totalSeconds",s()-t(this.element).data("startTime")),i(this),t(this.element).data("duration")&&t(this.element).data("totalSeconds")%t(this.element).data("duration")===0&&(this.options.repeat||(t(this.element).data("duration",null),this.options.duration=null),this.options.countdown&&(n(this),this.options.countdown=!1,t(this.element).data("state",b)),this.options.callback())}function i(e){var n=e.element,a=t(n).data("totalSeconds");e.options.countdown&&t(n).data("duration")>0&&(a=t(n).data("duration")-t(n).data("totalSeconds")),t(n)[v](d(a,e)),t(n).data("seconds",a)}function o(e){var n=e.element;t(n).on("focus",function(){c(e)}),t(n).on("blur",function(){var a,i=t(n)[v]();i.indexOf("sec")>0?t(n).data("totalSeconds",Number(i.replace(/\ssec/g,""))):i.indexOf("min")>0?(i=i.replace(/\smin/g,""),a=i.split(":"),t(n).data("totalSeconds",Number(60*a[0])+Number(a[1]))):i.match(/\d{1,2}:\d{2}:\d{2}/)&&(a=i.split(":"),t(n).data("totalSeconds",Number(3600*a[0])+Number(60*a[1])+Number(a[2]))),m(e)})}function s(){return Math.round((new Date).getTime()/1e3)}function r(t){var e,n=0,a=Math.floor(t/60);return t>=3600&&(n=Math.floor(t/3600)),t>=3600&&(a=Math.floor(t%3600/60)),10>a&&n>0&&(a="0"+a),e=t%60,10>e&&(a>0||n>0)&&(e="0"+e),{hours:n,minutes:a,seconds:e}}function d(t,e){var n="",a=r(t);if(e.options.format){var i=[{identifier:"%h",value:a.hours,pad:!1},{identifier:"%m",value:a.minutes,pad:!1},{identifier:"%s",value:a.seconds,pad:!1},{identifier:"%H",value:parseInt(a.hours),pad:!0},{identifier:"%M",value:parseInt(a.minutes),pad:!0},{identifier:"%S",value:parseInt(a.seconds),pad:!0}];n=e.options.format,i.forEach(function(t){n=n.replace(new RegExp(t.identifier.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1"),"g"),t.pad&&t.value<10?"0"+t.value:t.value)})}else n=a.hours?a.hours+":"+a.minutes+":"+a.seconds:a.minutes?a.minutes+":"+a.seconds+" min":a.seconds+" sec";return n}function u(t){if(!isNaN(Number(t)))return t;var e=t.match(/\d{1,2}h/),n=t.match(/\d{1,2}m/),a=t.match(/\d{1,2}s/),i=0;return t=t.toLowerCase(),e&&(i+=3600*Number(e[0].replace("h",""))),n&&(i+=60*Number(n[0].replace("m",""))),a&&(i+=Number(a[0].replace("s",""))),i}function l(n){var a=n.element;t(a).data("isTimerRunning")||(i(n),e(n),t(a).data("state",T),n.options.startTimer.bind(n).call())}function c(e){var a=e.element;t(a).data("isTimerRunning")&&(n(e),t(a).data("state",g),e.options.pauseTimer.bind(e).call())}function m(n){var a=n.element;t(a).data("isTimerRunning")||(t(a).data("startTime",s()-t(a).data("totalSeconds")),e(n),t(a).data("state",T),n.options.resumeTimer.bind(n).call())}function p(e){var n=e.element;t(n).data("startTime",0),t(n).data("totalSeconds",0),t(n).data("seconds",0),t(n).data("state",b),t(n).data("duration",e.options.duration),e.options.resetTimer.bind(e).call()}function f(e){var a=e.element;n(e),e.options.removeTimer.bind(e).call(),t(a).data("plugin_"+S,null),t(a).data("seconds",null),t(a).data("state",null),t(a)[v]("")}var h={seconds:0,editable:!1,restart:!1,duration:null,callback:function(){alert("Time up!")},startTimer:function(){},pauseTimer:function(){},resumeTimer:function(){},resetTimer:function(){},removeTimer:function(){},repeat:!1,countdown:!1,format:null,updateFrequency:1e3,state:"running"},v="html",b="stopped",T="running",g="paused",N=function(e,n){var a;this.options=h=t.extend(this.options,h,n),this.element=e,t(e).data("totalSeconds",h.seconds),t(e).data("startTime",s()-t(e).data("totalSeconds")),t(e).data("seconds",t(e).data("totalSeconds")),t(e).data("state",b),a=t(e).prop("tagName").toLowerCase(),("input"===a||"textarea"===a)&&(v="val"),this.options.duration&&(t(e).data("duration",u(this.options.duration)),this.options.duration=u(this.options.duration)),this.options.editable&&o(this)};N.prototype={start:function(){l(this)},pause:function(){c(this)},resume:function(){m(this)},reset:function(){p(this)},remove:function(){f(this)}};var S="timer";t.fn[S]=function(e){return e=e||"start",this.each(function(){t.data(this,"plugin_"+S)instanceof N||t.data(this,"plugin_"+S,new N(this,e));var n=t.data(this,"plugin_"+S);"string"==typeof e&&"function"==typeof n[e]&&n[e].call(n),"object"==typeof e&&(n.options.state===T?n.start.call(n):i(n))})}});